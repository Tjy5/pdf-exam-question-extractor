# 智能试卷处理系统 Web 界面使用指南

## 📖 简介

这是一个基于 PaddleOCR 的智能试卷处理系统的 Web 界面，让您无需了解代码即可轻松处理 PDF 试卷！

### ✨ 主要功能

1. **PDF 转图片** - 自动将 PDF 试卷转换为高清图像
2. **智能切题** - 使用 AI 自动识别并分割每道题目
3. **资料分析重组** - 智能识别跨页的资料分析大题
4. **长图拼接** - 将分散的题目和选项拼接成完整图片
5. **结果下载** - 一键打包下载所有题目图片

## 🚀 快速开始

### 1. 安装依赖

#### Windows 用户：
```bash
# 安装基础依赖（如果还没安装）
pip install -r requirements.txt

# 安装 Web 界面依赖
pip install -r web_requirements.txt
```

#### Linux/Mac 用户：
```bash
# 安装基础依赖（如果还没安装）
pip3 install -r requirements.txt

# 安装 Web 界面依赖
pip3 install -r web_requirements.txt
```

### 2. 启动服务

#### Windows 用户：
双击运行 `start_web.bat` 文件，或在命令行中执行：
```bash
start_web.bat
```

#### Linux/Mac 用户：
在终端中执行：
```bash
chmod +x start_web.sh
./start_web.sh
```

### 3. 打开浏览器

启动成功后，在浏览器中访问：
```
http://localhost:8000
```

## 💡 使用步骤

### 步骤 1：上传 PDF 文件

1. 点击上传区域，或直接拖拽 PDF 文件到上传框
2. 支持的格式：`.pdf`
3. 建议文件大小：小于 100MB

### 步骤 2：开始处理

1. 上传完成后，点击「开始处理」按钮
2. 系统会自动执行 5 个步骤：
   - **PDF 转图片** - 转换每一页为高分辨率图像
   - **题目提取** - AI 智能识别并分割题目
   - **资料分析重组** - 识别跨页的资料分析题
   - **长图拼接** - 拼接分散的题目和选项
   - **结果汇总** - 整理所有题目图片

### 步骤 3：查看进度

- 左侧「系统日志」窗口实时显示处理进度
- 右侧「处理流程进度」可视化展示当前步骤
- 每个步骤完成后会显示 ✓ 标记

### 步骤 4：查看和下载结果

处理完成后：
- 在「识别结果展示」区域查看所有题目图片
- 点击图片可预览大图
- 点击「批量下载」按钮下载所有题目（ZIP 格式）

## 🎨 界面说明

### 左侧面板
- **文件上传区** - 支持点击选择或拖拽上传 PDF
- **系统日志** - 终端风格的实时日志显示

### 右侧面板
- **处理流程进度** - 可视化的流程步骤指示器
- **识别结果展示** - 网格布局的题目图片画廊

## 📁 生成的文件

处理完成后，系统会在 `pdf_images/` 目录下创建以下文件（目录名默认使用试卷文件名；若同名但内容不同会自动生成 `_v2/_v3...` 版本号）：

```
pdf_images/
└── [试卷名称]/
    ├── page_1.png            # 原始页面图片
    ├── page_2.png
    ├── ...
    ├── questions_page_1/     # 第1页的题目
    │   ├── q1.png
    │   ├── q2.png
    │   └── meta.json         # 元数据
    ├── questions_page_2/
    │   └── ...
    └── all_questions/        # 汇总的所有题目
        ├── q1.png
        ├── q2.png
        ├── data_analysis_1.png
        └── ...
```

## ⚠️ 注意事项

1. **首次运行**
   - 首次运行会自动下载 PaddleOCR 模型（约 100MB）
   - 需要网络连接，国内用户可能需要镜像源

2. **处理时间**
   - 处理时间取决于 PDF 页数和题目数量
   - 一般 10-20 页的试卷需要 2-5 分钟
   - 请耐心等待，不要关闭浏览器

3. **系统要求**
   - Python 3.8 或更高版本
   - 推荐 8GB 以上内存
   - 有 GPU 可以显著加速（可选）

4. **浏览器兼容性**
   - 推荐使用 Chrome、Edge、Firefox 等现代浏览器
   - 不支持 IE 浏览器

## 🐛 常见问题

### Q: 启动失败，提示缺少依赖？
**A:** 请确保已安装所有依赖：
```bash
pip install -r requirements.txt
pip install -r web_requirements.txt
```

### Q: 上传文件后一直在「等待」状态？
**A:** 检查系统日志，可能是：
- PaddleOCR 模型正在下载
- Python 环境问题
- 磁盘空间不足

### Q: 处理失败，日志显示错误？
**A:** 常见原因：
- PDF 文件损坏或格式不支持
- 内存不足（尝试处理更小的文件）
- PaddleOCR 安装不完整

### Q: 题目切分不准确？
**A:** 这个工具针对标准格式的行测试卷优化，如果您的试卷格式特殊，可能需要调整算法参数。

### Q: 如何停止服务器？
**A:** 在终端窗口按 `Ctrl+C` 停止服务器。

## 📞 技术支持

如果遇到问题：
1. 查看系统日志中的错误信息
2. 检查 `web_interface/uploads/` 目录权限
3. 查阅项目根目录的 `README.md` 文件
4. 访问 GitHub 提交 Issue

## 🎉 享受使用！

现在您可以轻松处理试卷，无需敲一行代码！

---

**提示**：如果您熟悉命令行，也可以继续使用 `cli_menu.py` 或直接运行各个 Python 脚本。
